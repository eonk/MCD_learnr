---
title: "Excercise for Modelling Criminological Data"
output:
  learnr::tutorial:
    allow_skip: true
runtime: shiny_prerendered
tutorial:
  # id: "com.example.tutorials.my-first-tutorial"
  version: 2.18
  # user_id: "barret"
description: >
  Excerices for MCD
---

```{r setup, include=FALSE}
library(learnr)
knitr::opts_chunk$set(echo = TRUE, highlight = TRUE)
```

## Overview

This is an optional exercise for Modelling Criminological Data. 

This will not be graded and is designed to help you to understand R codes in every sessions.

-------------------

## Week 1

This week we used the following R functions: 

**install and load a package**

+ `install.packages()`

+ `library()`

**generate and print data**

+ `my_text <- "I love stats."`

+ `print()`

+ `say()`

**explore data**

+ `search()`

+ `skim()`

+ `attribute()`

+ `mean()`

+ `summary()`

+ `str()`

**transform variables into factor variables**

+ `as_factor()`

-------------------

### Installing and loading a package

```{r q1_1, echo = FALSE}
question_text(
  "Let's say you want to install a package called, 'cowsay'. 
  
  As you have not installed the packge in your Rstudio yet, you need to install the packge first. 
  
  Please enter the code you need to install the packge below:",
 
  answer("install.packges(\"Cowsay\")", message = "Don't forget to decapitalize, R is case-sensitive"),
  answer("install.packge(\"cowsay\")", message = "Don't forget to use plural, packges"),
  answer("install.packges(cowsay)", message = "Don't forget to use quotation marks"),
  answer("install.packges(\"cowsay\")", correct = TRUE),
  allow_retry = TRUE
)
```

```{r q1_2, echo = FALSE}
question_radio(
  "After you succesfully installed 'cowsay', you wanted to use 'say()' function in the package. 
  
  You ran 'say(my_text)' but R returned: 
  
  'Error in say(my_text) : could not find function \"say\"' 
  
  What does the error message tell you? How can you fix this one?:",
  
  answer("Something wrong with Rstudio. So, restart the programme", message = "Nice try"),
  answer("Blame your computer. Always stop working when you want to study. Ask mum to get you a new laptop", message = "Good reason for a new laptop"),
  answer("Try an hour later, give R time to think", message = "Really, really?"),
  answer("You realised you forgot to invoke the library(package) command to load it into the current session. Load a package using 'load(cowsay)' code and fix it", correct = TRUE),
  allow_retry = TRUE
)
```

-------------------

## Week 2

This week we used the following R functions: 

**read data: 'haven' package**

+ `read_dta()`

**explore data**

+ `dim()`

+ `names()`

+ `class()`

+ `attribute()`

+ `head()`

+ `tail()`

+ `table()`

+ `lapply()`

+ `sum()`

+ `mean()`

**transform variables into factor variables**

+ `as_factor()`

**missing variable**

+ `is.na()`

**'dplyr' package**

+ `filter()`

+ `select()`

+ `group_by()`

+ `summarise()`

-------------------

### Descriptive analysis on 'Categorial data'

```{r q2_1, echo = FALSE}
question_text(
  "Let's say you are analysing a variable 'criminal_record'(reoffending criminal records of prisoners) using 'recidivism' data. 
  
  The variable has two values 'Yes' and 'No'. To calculate a count of obervation on the valid value of the 'criminal_record' variable, you want to use the table() function. 
  
  Please enter the code you need to get a count of observations (see 2.3.2 in the lab note):",
  
  
  answer("table(criminal_record)", message = "Don't forget to start with the data name"),
  answer("table(recidivism$criminal_record)", correct = TRUE),
  allow_retry = TRUE
)
```

### Data manipulation: missing variable

```{r q2_2, echo = FALSE}
question_radio(
  "You found the 'criminal_record' variable has some missing observations. 
  
  To see how many observations are missing, which code would you use?:",
  
  answer("select(recidivism, criminal_record)", message = "nah- this is fo 'variable selection"),
  answer("mean(is.na(recidivism$criminal_record))", message = "mean? really?"),
  answer("class(recidivism$criminal_record)", message = "think twice"),
  answer("sum(is.na(recidivism$criminal_record))", correct = TRUE),
  allow_retry = TRUE
)
```

### Data manipulation: dplyr

<img src="https://user-images.githubusercontent.com/98951792/217301605-8f3f74e3-4b81-46f7-aec0-bd9701cc81e7.png">
```{r q2_3, echo = FALSE}
question_radio(
  "dplyr is a grammar of data manipulation, providing a consistent set of verbs that help you solve the most common data manipulation challenges.
  
  Let's say you are intersted in ONLY prisoners who have previous crime records not all of them.
  
  Again, they are recorded as 'Yes' to the 'criminal_record' variable. 
  
  To filter these observations which code would you use:",
  
  answer("mutate(recidivism, criminal_record == 'Yes')", message = "nah- this is for 'variable selection"),
  answer("select(recidivism, criminal_record == 'Yes')", message = "this will tell you proportion, not count"),
  answer("filter(recidivism, criminal_record == 'Yes')", correct = TRUE),
  answer("summarise(recidivism, criminal_record == 'Yes')", message = "cmon-"),
  allow_retry = TRUE
)
```

-------------------

## Week 3

This week we used the following R functions: 

**import data: 'readr' package**

+ `read_csv()`

**explore data**

+ `names()`

**clean data: janitor package**

+ `clean_names()`

**visualise data**

+ `ggplot()`

+ `+ geom_bar()`

+ `+ geom_point()`

+ `+ geom_histogram()`

+ `+ geom_density()`

+ `+ geom_hline()`

+ `+ geom_boxplot()`

+ `+ facet_warp()`

+ `+ facet_grid`

**transform a variable into a factor variable**

+ `as_factor()`

**create a categorical variable using a numeric variable**

+ `Boston$lowval[Boston$medv <= 17.02] <- "Low value"`

-------------------

### transform data

```{r q3_1, echo = FALSE}
question_text(
  "The 'prison' data we used for this week homework task has a variable 'gdpPercap' and lets say you want to create a new categorical variables 'high_low_gdp' using the 'gdpPercap' variable. 
  
  The mean value of 'gdpPercap' is 11888.5 and you want to make two values 'low_gdp' and 'high_gdp' using the mean value. 
  
  Ok, so the data name is 'prison', the numeric variable is 'gdpPercap',  the new categorical varaible is 'high_low_gdp', and you are creating one of the values, 'high_gdp' using the mean value, 11888.5.
  
  Apply the code we learn in week 3 'Boston$lowval[Boston$medv > 17.02] <- \"Higher value\"' please enter the code you need to put in the blank space below (see 3.4 in the lab note)
  
  _______________________________________________ <- \"high_gdp\"",
  
  answer("prisongdpPercap$[prison$high_low_gdp > 11888.5]", message = "so close! let's try again"),
  answer("prison$high_low_gdp[prison$gdpPercap > 11888.5]", correct = TRUE),
  answer("prison$high_low_gdp[prison$gdpPercap>11888.5]", correct = TRUE),
  answer("prison$high_low_gdp[prison$gdpPercap> 11888.5]", correct = TRUE),
  answer("prison$high_low_gdp[prison$gdpPercap >11888.5]", correct = TRUE),
  answer("prison$high_low_gdp[prison$gdpPercap >11888.5]" , correct = TRUE),
  allow_retry = TRUE
)
```

### visualise data

<img src="https://user-images.githubusercontent.com/98951792/219618616-8a3833e2-a6c9-4e24-8e42-3f5b66d2c8ed.png">
```{r q3_2, echo = FALSE}
question_radio(
  "ggplot2 is a plotting package that provides helpful commands to create complex plots from data in a data frame. 
  
  Here we are going to create a graph presenting the correlation of two variables 'assaults' and 'domestic_violence'.
  
  What variable is mapped to y, and what is mapped to x, and what is mapped to color?:",
  
  answer("aes(x=assaults, y=domestic_violence, fill=police999call)", message = "nah- diff colour option we are using"),
  answer("aes(x=assaults, y=domestic_violence, colour=police999call)", correct = TRUE),
  answer("aes(x=domestic_violence, y=assaults, colour=police999call)", message = "see the variable names on the xy-axis"),
  answer("aes(x=domestic_violence, y=assaults, alpha=police999call)", message = "cmon-"),
  allow_retry = TRUE
)
```

-------------------

## Week 4

This week we used the following R functions: 

**import data: 'haven' package**

+ `read_dta()`

**explore data**

+ `class()`

+ `attributes()`

+ `summary()`

+ `skim()`

+ `mosaic()`

+ `vis_dat()`

**explore data: descriptive statistics**

+ `table()`

+ `mean()`

+ `median()`

+ `modeest::mlv()`

**manipulate data: dplyr package**

+ `select()`

+ `mutate()`

**manpulate data: missing variable**

+ `na.omit()`

+ `colMeans(is.na())`

+ `df$at_sexviol[df$qb10_11 == 1 | df$qb10_12 == 1] <- NA`

+ `levels(df$urban_f)[levels(df$urban_f) == 'DK'] <- NA`

**change a variable name**

+ `rename()`

+ `colnames(df)[colnames(df)=="d10"] <- "gender"`

+ `names(df)[4:7] <- c("age", "politics", "urban", "occupation")`

**creat list**

+ `northern_list <- c("DK", "FI", "SE")`

**transform a variable into a factor variable**

+ `as_factor()`

**transform a variable into a numeric variable**

+ `as.numeric()`

**create a categorical variable using a numeric variable**

+ `Boston$lowval[Boston$medv <= 17.02] <- "Low value"`

-------------------

### transform data

```{r q3_1, echo = FALSE}
question_text(
  "The 'prison' data we used for this week homework task has a variable 'gdpPercap' and lets say you want to create a new categorical variables 'high_low_gdp' using the 'gdpPercap' variable. 
  
  The mean value of 'gdpPercap' is 11888.5 and you want to make two values 'low_gdp' and 'high_gdp' using the mean value. 
  
  Ok, so the data name is 'prison', the numeric variable is 'gdpPercap',  the new categorical varaible is 'high_low_gdp', and you are creating one of the values, 'high_gdp' using the mean value, 11888.5.
  
  Apply the code we learn in week 3 'Boston$lowval[Boston$medv > 17.02] <- \"Higher value\"' please enter the code you need to put in the blank space below (see 3.4 in the lab note)
  
  _______________________________________________ <- \"high_gdp\"",
  
  answer("prisongdpPercap$[prison$high_low_gdp > 11888.5]", message = "so close! let's try again"),
  answer("prison$high_low_gdp[prison$gdpPercap > 11888.5]", correct = TRUE),
  answer("prison$high_low_gdp[prison$gdpPercap>11888.5]", correct = TRUE),
  answer("prison$high_low_gdp[prison$gdpPercap> 11888.5]", correct = TRUE),
  answer("prison$high_low_gdp[prison$gdpPercap >11888.5]", correct = TRUE),
  answer("prison$high_low_gdp[prison$gdpPercap >11888.5]" , correct = TRUE),
  allow_retry = TRUE
)
```

### visualise data

<img src="https://user-images.githubusercontent.com/98951792/219618616-8a3833e2-a6c9-4e24-8e42-3f5b66d2c8ed.png">
```{r q3_2, echo = FALSE}
question_radio(
  "ggplot2 is a plotting package that provides helpful commands to create complex plots from data in a data frame. 
  
  Here we are going to create a graph presenting the correlation of two variables 'assaults' and 'domestic_violence'.
  
  What variable is mapped to y, and what is mapped to x, and what is mapped to color?:",
  
  answer("aes(x=assaults, y=domestic_violence, fill=police999call)", message = "nah- diff colour option we are using"),
  answer("aes(x=assaults, y=domestic_violence, colour=police999call)", correct = TRUE),
  answer("aes(x=domestic_violence, y=assaults, colour=police999call)", message = "see the variable names on the xy-axis"),
  answer("aes(x=domestic_violence, y=assaults, alpha=police999call)", message = "cmon-"),
  allow_retry = TRUE
)
```

